!function e(t,o,n){function r(i,a){if(!o[i]){if(!t[i]){var l="function"==typeof require&&require;if(!a&&l)return l(i,!0);if(s)return s(i,!0);var d=new Error("Cannot find module '"+i+"'");throw d.code="MODULE_NOT_FOUND",d}var u=o[i]={exports:{}};t[i][0].call(u.exports,function(e){var o=t[i][1][e];return r(o||e)},u,u.exports,e,t,o,n)}return o[i].exports}for(var s="function"==typeof require&&require,i=0;i<n.length;i++)r(n[i]);return r}({1:[function(e,t,o){var n={};window.setkaWorkflowAdminGeneralPage=n,n.views={Page:e("./views/Page"),ExportButton:e("./views/ExportButton"),PostAuthorId:e("./views/PostAuthorId")},n.utils={ExportTerms:e("./utils/ExportTerms")}},{"./utils/ExportTerms":2,"./views/ExportButton":3,"./views/Page":4,"./views/PostAuthorId":5}],2:[function(e,t,o){var n=jQuery,r=window.setkaWorkflowAdminGeneralPageConfig;t.exports=Backbone.View.extend({_waitResponse:!1,initialize:function(){_.bindAll(this,"done","fail")},exportTerm:function(){if(this._waitResponse)return this;n.ajax({url:window.ajaxurl,type:"post",timeout:45e3,data:{action:r.action,actionName:r.actionExportCategories},dataType:"json",jsonp:!1,cache:!1}).done(this.done).fail(this.fail);this._waitResponse=!0},done:function(e,t,o){this._waitResponse=!1,Backbone.trigger("setka:workflow:exportTerm:done",e,t,o)},fail:function(e,t,o){this._waitResponse=!1,Backbone.trigger("setka:workflow:exportTerm:fail",e,t,o)}})},{}],3:[function(e,t,o){window.setkaWorkflowAdminGeneralPage,jQuery,window.setkaWorkflowAdminGeneralPageConfig,window.setkaWorkflowAdminGeneralPageConfig.translations;t.exports=Backbone.View.extend({disable:function(){return this.$el.attr("disabled","disabled"),this},enable:function(){return this.$el.removeAttr("disabled"),this}})},{}],4:[function(e,t,o){var n=window.setkaWorkflowAdminGeneralPage,r=jQuery,s=window.setkaWorkflowAdminGeneralPageConfig,i=window.setkaWorkflowAdminGeneralPageConfig.translations;t.exports=Backbone.View.extend({views:{},utils:{},DOM:{exportButton:null,postAuthorId:null,errors:null,log:null,progress:null},initialize:function(){_.bindAll(this,"onExportButtonClick","onExported","onExportFailed","exportTerm"),this.setupDOM().setupUtils().addEvents()},setupDOM:function(){return this.DOM.exportButton=new n.views.ExportButton({el:s.elements.exportButton,model:this.model}),this.DOM.postAuthorId=new n.views.PostAuthorId({model:this.model}),this.DOM.errors=r(s.elements.exportErrors),this.DOM.log=r(s.elements.exportLog),this},setupUtils:function(){return this.utils.exportTerms=new n.utils.ExportTerms,this},addEvents:function(){return this.DOM.exportButton.$el.click(this.onExportButtonClick),Backbone.on("setka:workflow:exportTerm:done",this.onExported),Backbone.on("setka:workflow:exportTerm:fail",this.onExportFailed),this},onExportButtonClick:function(e){e.preventDefault(),this.initialExport().exportTerm()},initialExport:function(){return this.DOM.exportButton.disable(),this.DOM.progress=r(s.elements.exportProgress).removeClass(s.elements.hidden).progressbar({value:!1}),this.DOM.errors.addClass(s.elements.hidden),this.DOM.log.addClass(s.elements.hidden),this},onExported:function(e,t,o){if(0===e.stat.notCreated)this.DOM.progress.addClass(s.elements.hidden);else{var n=100*e.stat.created/e.stat.total;n<5&&(n=5),this.DOM.progress.removeClass(s.elements.hidden).progressbar({value:n})}_.isUndefined(e.errors)?r(this.DOM.errors).addClass(s.elements.hidden):(_.each(e.errors,function(e,t,o){r(this.DOM.errors).text(e.message)},this),r(this.DOM.errors).removeClass(s.elements.hidden)),_.isUndefined(e.entity)?r(this.DOM.log).addClass(s.elements.hidden):(0===e.stat.notCreated?r(this.DOM.log).text(i.exportSuccessfulFinished):r(this.DOM.log).text(i.exportedResult.replace("%1$s",e.entity.wordpress.name)),r(this.DOM.log).removeClass(s.elements.hidden)),e.stat.notCreated>0&&_.isUndefined(e.errors)?this.exportTerm():(this.DOM.progress.addClass(s.elements.hidden),this.DOM.exportButton.enable())},onExportFailed:function(e,t,o){this.DOM.progress.addClass(s.elements.hidden),this.DOM.log.addClass(s.elements.hidden),r(this.DOM.errors).text(i.connectToWordPressError).removeClass(s.elements.hidden),this.DOM.exportButton.enable()},exportTerm:function(){return this.utils.exportTerms.exportTerm(),this}})},{}],5:[function(e,t,o){window.setkaWorkflowAdminGeneralPage,jQuery;var n=window.setkaWorkflowAdminGeneralPageConfig;window.setkaWorkflowAdminGeneralPageConfig.translations;t.exports=Backbone.View.extend({el:n.elements.postAuthorId,initialize:function(){this.$el.select2({ajax:{url:ajaxurl,dataType:"json",minimumInputLength:3,delay:300,allowClear:!0,data:function(e){return e.action=n.action,e.actionName=n.actionSearchUsers,e}}})}})},{}]},{},[1]);
//# sourceMappingURL=general-page.min.js.map